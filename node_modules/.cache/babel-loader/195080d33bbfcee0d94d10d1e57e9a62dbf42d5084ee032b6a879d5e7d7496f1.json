{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.typed-array.to-reversed.js\";\nimport \"core-js/modules/es.typed-array.to-sorted.js\";\nimport \"core-js/modules/es.typed-array.with.js\";\nimport { bankaccounts, items, shopusers, transactions } from './data';\nimport { v4 as uuidv4 } from 'uuid';\nfunction shopLogin(data) {\n  if (!data.login || !data.password) return {\n    error: 1,\n    status: 404,\n    data: 'aucun login/pass fourni'\n  };\n  let user = shopusers.find(e => e.login === data.login);\n  if (!user) return {\n    error: 1,\n    status: 404,\n    data: 'login/pass incorrect'\n  };\n  if (!user.uuid) user.uuid = uuidv4();\n  return {\n    error: 0,\n    status: 200,\n    data: user\n  };\n}\nfunction getAllViruses() {\n  return {\n    error: 0,\n    data: items\n  };\n}\nfunction getAccountAmount(number) {\n  if (!number) return {\n    error: 1,\n    status: 404,\n    data: 'aucun numéro de compte bancaire fourni'\n  };\n  let account = bankaccounts.find(a => a.number === number);\n  if (!account) return {\n    error: 1,\n    status: 404,\n    data: 'numéro de compte bancaire incorrect'\n  };\n  return {\n    error: 0,\n    status: 200,\n    data: account.amount\n  };\n}\nfunction getAccountTransactions(number) {\n  if (!number) return {\n    error: 1,\n    status: 404,\n    data: 'aucun numéro de compte bancaire fourni'\n  };\n  let account = bankaccounts.find(a => a.number === number);\n  if (!account) return {\n    error: 1,\n    status: 404,\n    data: 'numéro de compte bancaire incorrect'\n  };\n  let trans = transactions.filter(t => t.account === account._id);\n  return {\n    error: 0,\n    status: 200,\n    data: trans\n  };\n}\nfunction getAccount(number) {\n  console.log(number);\n  if (!number) return {\n    error: 1,\n    status: 404,\n    data: 'aucun numéro de compte bancaire fourni'\n  };\n  let account = bankaccounts.find(a => a.number === number);\n  if (!account) return {\n    error: 1,\n    status: 404,\n    data: 'numéro de compte bancaire incorrect'\n  };\n  return account;\n}\nfunction getTransactions(id_account) {\n  if (!id_account) return {\n    error: 1,\n    status: 404,\n    data: 'aucun numéro de compte bancaire fourni'\n  };\n  let transAccount = transactions.find(a => a.account === id_account);\n  let transDest = transactions.find(a => a.destination === id_account);\n  if (!transAccount && !transDest) return {\n    error: 1,\n    status: 404,\n    data: 'aucune transaction pour ce compte'\n  };\n}\nfunction createWithdraw(id_account, amount) {\n  if (!id_account) return {\n    error: 1,\n    status: 404,\n    data: 'aucun numéro de compte bancaire fourni'\n  };\n  let account = bankaccounts.find(a => a._id === id_account);\n  if (!account) return {\n    error: 1,\n    status: 404,\n    data: 'numéro de compte bancaire incorrect'\n  };\n  let newTrans = {\n    _id: generateId(),\n    amount: -amount,\n    account: id_account,\n    date: {\n      $date: new Date().toISOString()\n    },\n    uuid: uuidv4()\n  };\n  account.amount -= amount;\n  let updatedAccountIndex = bankaccounts.findIndex(a => a._id === id_account);\n  bankaccounts[updatedAccountIndex].amount = account.amount;\n  transactions.push(newTrans);\n  return {\n    error: 0,\n    status: 200,\n    data: {\n      uuid: newTrans.uuid,\n      amount: account.amount\n    }\n  };\n}\nfunction generateId() {\n  const byteArray = new Uint8Array(12);\n  window.crypto.getRandomValues(byteArray);\n  return Array.from(byteArray).map(byte => byte.toString(16).padStart(2, '0')).join('');\n}\nfunction createPayment(id_account, amount, destination) {\n  if (!id_account) return {\n    error: 1,\n    status: 404,\n    data: 'aucun numéro de compte bancaire fourni'\n  };\n  let account = bankaccounts.find(a => a._id === id_account);\n  if (!account) return {\n    error: 1,\n    status: 404,\n    data: 'numéro de compte bancaire incorrect'\n  };\n  let destAccount = bankaccounts.find(a => a._id === destination);\n  if (!destAccount) return {\n    error: 1,\n    status: 404,\n    data: 'compte destinataire inexistant'\n  };\n  let newTrans = {\n    _id: generateId(),\n    amount: amount,\n    account: id_account,\n    destination: destination,\n    date: {\n      $date: new Date().toISOString()\n    },\n    uuid: uuidv4()\n  };\n  account.amount -= amount;\n  destAccount.amount += amount;\n  let updatedAccountIndex = bankaccounts.findIndex(a => a._id === id_account);\n  let updatedDestAccountIndex = bankaccounts.findIndex(a => a._id === destination);\n  bankaccounts[updatedAccountIndex].amount = account.amount;\n  bankaccounts[updatedDestAccountIndex].amount = destAccount.amount;\n  transactions.push(newTrans);\n  return {\n    error: 0,\n    status: 200,\n    data: {\n      uuid: newTrans.uuid,\n      amount: account.amount\n    }\n  };\n}\nexport default {\n  shopLogin,\n  getAllViruses,\n  getAccountAmount,\n  getAccountTransactions,\n  getAccount,\n  getTransactions,\n  createWithdraw,\n  createPayment\n};","map":{"version":3,"names":["bankaccounts","items","shopusers","transactions","v4","uuidv4","shopLogin","data","login","password","error","status","user","find","e","uuid","getAllViruses","getAccountAmount","number","account","a","amount","getAccountTransactions","trans","filter","t","_id","getAccount","console","log","getTransactions","id_account","transAccount","transDest","destination","createWithdraw","newTrans","generateId","date","$date","Date","toISOString","updatedAccountIndex","findIndex","push","byteArray","Uint8Array","window","crypto","getRandomValues","Array","from","map","byte","toString","padStart","join","createPayment","destAccount","updatedDestAccountIndex"],"sources":["/home/arthur/Documents/BUT/BUT2/Dev web/S3/Front-end/S3/tp4_v2/src/datasource/controller.js"],"sourcesContent":["import {bankaccounts, items, shopusers, transactions} from './data';\nimport {v4 as uuidv4} from 'uuid';\n\nfunction shopLogin(data) {\n  if ((!data.login) || (!data.password)) return {error: 1, status: 404, data: 'aucun login/pass fourni'};\n  let user = shopusers.find(e => e.login === data.login);\n  if (!user) return {error: 1, status: 404, data: 'login/pass incorrect'};\n  if (!user.uuid) user.uuid = uuidv4();\n  return {error: 0, status: 200, data: user};\n}\n\nfunction getAllViruses() {\n  return {error: 0, data: items};\n}\n\nfunction getAccountAmount(number) {\n  if (!number) return {error: 1, status: 404, data: 'aucun numéro de compte bancaire fourni'};\n  let account = bankaccounts.find(a => a.number === number);\n  if (!account) return {error: 1, status: 404, data: 'numéro de compte bancaire incorrect'};\n  return {error: 0, status: 200, data: account.amount};\n}\n\nfunction getAccountTransactions(number) {\n  if (!number) return {error: 1, status: 404, data: 'aucun numéro de compte bancaire fourni'};\n  let account = bankaccounts.find(a => a.number === number);\n  if (!account) return {error: 1, status: 404, data: 'numéro de compte bancaire incorrect'};\n  let trans = transactions.filter(t => t.account === account._id);\n  return {error: 0, status: 200, data: trans};\n}\n\nfunction getAccount(number){\n  console.log(number)\n  if (!number) return {error: 1, status: 404, data: 'aucun numéro de compte bancaire fourni'};\n  let account = bankaccounts.find(a => a.number === number);\n  if (!account) return {error: 1, status: 404, data: 'numéro de compte bancaire incorrect'};\n  return account;\n}\n\nfunction getTransactions(id_account){\n  if (!id_account) return {error: 1, status: 404, data: 'aucun numéro de compte bancaire fourni'};\n  let transAccount = transactions.find(a => a.account === id_account);\n  let transDest = transactions.find(a => a.destination === id_account);\n  if (!transAccount && !transDest) return {error: 1, status: 404, data: 'aucune transaction pour ce compte'};\n}\n\nfunction createWithdraw(id_account, amount) {\n  if (!id_account) return { error: 1, status: 404, data: 'aucun numéro de compte bancaire fourni' };\n  let account = bankaccounts.find(a => a._id === id_account);\n  if (!account) return { error: 1, status: 404, data: 'numéro de compte bancaire incorrect' };\n  let newTrans = {\n    _id: generateId(),\n    amount: -amount,\n    account: id_account,\n    date: { $date: new Date().toISOString() },\n    uuid: uuidv4()\n  };\n  account.amount -= amount;\n  let updatedAccountIndex = bankaccounts.findIndex(a => a._id === id_account);\n  bankaccounts[updatedAccountIndex].amount = account.amount;\n  transactions.push(newTrans);\n  return { error: 0, status: 200, data: { uuid: newTrans.uuid, amount: account.amount } };\n}\n\nfunction generateId() {\n  const byteArray = new Uint8Array(12);\n  window.crypto.getRandomValues(byteArray);\n  return Array.from(byteArray).map(byte => byte.toString(16).padStart(2, '0')).join('');\n}\n\nfunction createPayment(id_account, amount, destination) {\n  if (!id_account) return { error: 1, status: 404, data: 'aucun numéro de compte bancaire fourni' };\n  let account = bankaccounts.find(a => a._id === id_account);\n  if (!account) return { error: 1, status: 404, data: 'numéro de compte bancaire incorrect' };\n  let destAccount = bankaccounts.find(a => a._id === destination);\n  if (!destAccount) return { error: 1, status: 404, data: 'compte destinataire inexistant' };\n  let newTrans = {\n    _id: generateId(),\n    amount: amount,\n    account: id_account,\n    destination: destination,\n    date: { $date: new Date().toISOString() },\n    uuid: uuidv4()\n  };\n  account.amount -= amount;\n  destAccount.amount += amount;\n  let updatedAccountIndex = bankaccounts.findIndex(a => a._id === id_account);\n  let updatedDestAccountIndex = bankaccounts.findIndex(a => a._id === destination);\n  bankaccounts[updatedAccountIndex].amount = account.amount;\n  bankaccounts[updatedDestAccountIndex].amount = destAccount.amount;\n  transactions.push(newTrans);\n  return { error: 0, status: 200, data: { uuid: newTrans.uuid, amount: account.amount } };\n}\n\nexport default{\n  shopLogin,\n  getAllViruses,\n  getAccountAmount,\n  getAccountTransactions,\n  getAccount,\n  getTransactions,\n  createWithdraw,\n  createPayment\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}